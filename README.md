ASN.1 library for C++
=====================

**Current progress:**

- [done] decoding of ASN.1 payloads (just 500 lines to decode an X.509 cert!)
- representing subset of schemas required to decode context dependent objects

**Next:**

- implement encoding ASN.1 payloads
- BER / DER rules
- configurable nesting limit or iterative recursion
- find test vectors
- add test suite
- benchmark


**Future:**

- implement schema parser
- implement programming language type mappings

Usage
=====

```
asn1 <file>
```

Decodes an ASN.1 payload, and prints it out in human-readable form. `file` can be an X.509 certificate, for example.

Build and run
=============

(The provided test_payload.crt is a cert for letsencrypt.org))

```
$ g++ asn1.cpp -o asn1 && ./asn1 test_payload.crt
SEQUENCE(
SEQUENCE(
(constructed)
INTEGER 02
INTEGER 03d415318e2c571d2905fc3e0527689d0d09
SEQUENCE(
OID(01.02.0348.01bb8d.01.01.0b)
NULL
)
SEQUENCE(
SET{
SEQUENCE(
OID(02.05.04.06)
PrintableString US
)
}
SET{
SEQUENCE(
OID(02.05.04.0a)
PrintableString Let's Encrypt
)
}
SET{
SEQUENCE(
OID(02.05.04.03)
PrintableString Let's Encrypt Authority X3
)
}
)
SEQUENCE(
UTCTime 190929163336Z
UTCTime 191228163336Z
)
SEQUENCE(
SET{
SEQUENCE(
OID(02.05.04.03)
PrintableString letsencrypt.org
)
}
)
SEQUENCE(
SEQUENCE(
OID(01.02.0348.01bb8d.01.01.01)
NULL
)
BIT STRING 3082010a0282010100d0027597588872d78d4873aa668710d67f998a74e7e6db270d1186690230ddf68aa3cfd3fdbf281462eb417cefe8ad48d70aa50fc7426126e4da1a1faac7ccfba286ff37e2883d4cfb0778cd103a468639c474d35874906465220ca75f31bb9123bb85301449b2dfcc20f81e9f2cc0b2470b3efceec9ffd3d0ef3e425d78786542fae07e7197aac1cba925e8f54b595eb8b0612d07442b7974a08b4ce400992e5ecca1b6fbb2d572e4101ac1b5b2dddfdadd3ddb327c0438ff840774661f2f291c240d9bcfcd9ce8efa838a46b553d18667039d52e29f83e6b32b167af11dce926134eec55c2b02036696a3878f0182ab47d063c8d94f010d9090a948fdc271f0203010001
)
(constructed)
SEQUENCE(
SEQUENCE(
OID(02.05.1d.0f)
BOOLEAN TRUE
OCTET STRING 030205a0
)
SEQUENCE(
OID(02.05.1d.25)
OCTET STRING 301406082b0601050507030106082b06010505070302
)
SEQUENCE(
OID(02.05.1d.13)
BOOLEAN TRUE
OCTET STRING 3000
)
SEQUENCE(
OID(02.05.1d.0e)
OCTET STRING 04147c2ba3e73c845f38d47677652bc54a586c8eddaa
)
SEQUENCE(
OID(02.05.1d.23)
OCTET STRING 30168014a84a6a63047dddbae6d139b7a64565eff3a8eca1
)
SEQUENCE(
OID(01.03.06.01.05.05.07.01.01)
OCTET STRING 3061302e06082b060105050730018622687474703a2f2f6f6373702e696e742d78332e6c657473656e63727970742e6f7267302f06082b060105050730028623687474703a2f2f636572742e696e742d78332e6c657473656e63727970742e6f72672f
)
SEQUENCE(
OID(02.05.1d.11)
OCTET STRING 3026820f6c657473656e63727970742e6f726782137777772e6c657473656e63727970742e6f7267
)
SEQUENCE(
OID(02.05.1d.20)
OCTET STRING 30433008060667810c0102013037060b2b0601040182df130101013028302606082b06010505070201161a687474703a2f2f6370732e6c657473656e63727970742e6f7267
)
SEQUENCE(
OID(01.03.06.01.04.01.2b79.02.04.02)
OCTET STRING 0481f000ee007500e2694bae26e8e94009e8861bb63b83d43ee7fe7488fba48f2893019dddf1dbfe0000016d7e15baee00000403004630440220144e1f1fdd2f4c9f3a966ced8ead79ac0e9f4a1ac21b96fb796f56ceb50e18dc02207666e6301eedc1c18b6a253a9fc2c8d0ce33199bc6d03aeb5d99eedd7da2d7be007500293c519654c83965baaa50fc5807d4b76fbf587a2972dca4c30cf4e54547f4780000016d7e15bae6000004030046304402204dcf3f4098b8a1d7d9210d6eef8cf3be40686ea6b4f166ffbf1a2a960be25182022069c016068f520fb1cca4d16464c63b8723f14189ddfe763680fa5168a93e022f
)
)
)
SEQUENCE(
OID(01.02.0348.01bb8d.01.01.0b)
NULL
)
BIT STRING 1697aec0be9ec182a656dd51161235c781a9e5a0cf0e1cc4ba7a7e92e3a9f2b96d22b46ced87c4a60ae1b88bb7ec79e7041b766c9b45354b577701f7c294ec16006c41e40ae4f01a63b33cbc9c6b4da3ba451fea6c1820468f5a67925b5ebb78d4ce49172874b4d03b276b57c9233b30803ed7edeb7c3d1bd5dee7c889d92fbdb7debf42f64d83d610530ced63b4788cac7fd593963b9f96071bcc95d8d0f6ad501ccbe7d7a489d259bc667b77e853975e027024eb67e5463199662bab4c841b9725d01ae51d10494a6a8ab1912f3dfb3b1f92561fed8c0f88dad711b347ae0285f47ad72be5c6c16a9578fba2ed494b7facb05d75e5c29c3c6a016431cb2d29
)
```

References
==========

Recommendation ITU-T X.680 International Standard 8824-1 Information technology - Abstract Syntax Notation One (ASN.1): Specification of basic notation (Identical to ISO/IEC 8824-1)

Maybe:

RFC 5280: Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile
